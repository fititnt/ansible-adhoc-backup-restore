---

# FILE:            {{ role_path }}/defaults/main.yml
# LICENSE:         Public Domain

# Data to export/import
mrm_name: "{{ mrm_name_default }}"
mrm_database: null         # -B, --database: Database to dump (defalts to ALL databases, including system databases!)
mrm_tables_list: ""        # --tables-list: Comma delimited table list to dump (does not exclude regex option)
mrm_regex: ""              # -x, --regex: Regular expression for 'db.table' matching
mrm_no_schemas: null       # -m, --no-schemas: Do not dump table schemas with the data
mrm_no_data: null          # -d, --no-data: Do not dump table data

# Server to export/import
mrm_dbserver_user: root     # -u, --user: Username with privileges to run the dump
mrm_dbserver_password: null # -p, --password: User password
mrm_dbserver_host: null     # --host: The host to connect to
mrm_dbserver_port: null     # -P, --port: TCP/IP port to connect to
mrm_dbserver_socket: null   # -S, --socket: UNIX domain socket file to use for connection

# For features not implemented, please use the following parameters
mrm_mydumper_append: null  # String to append to mydumper shell command
mrm_myloader_append: null  # String to append to myloader shell command

# Less common options
# @see https://dba.stackexchange.com/questions/99007/how-does-mydumpers-use-savepoints-option-reduce-metadata-locking

# Paranoid Mode ________________________________________________________________
# If enabled: 
#    - run full-temp-backup-before-recovery
#    - It will take additional time (it will backup all databases on target reserver)
#    - It may fill your disks (if your database is big and the target directory is on small disk)
mrm_paranoid: false

## Other variables _____________________________________________________________

mrm_setup_mydumper_myloader: yes
mrm_setup_rclone: yes
mrm_setup_mrm_filesystem: yes
mrm_backup_disabled: no
mrm_recovery_disabled: no
mrm_valt_send_disabled: no
mrm_valt_receive_disabled: no
mrm_mode: "undefined-mode-select-backup-or-recovery"

## Filesystem __________________________________________________________________

# With 'mrm_setup_mrm_filesystem: yes', mrm_dirs is used to prepare local
# filesystem. You can append other directories here
mrm_fs_dirs:
  - "{{ mrm_dir_base }}"
  - "{{ mrm_dir_backup }}"
  - "{{ mrm_dir_mydumperdaemon }}"
  - "{{ mrm_dir_paranoidmode }}"

# You do not plan to run always as root? Customize this
mrm_fs_owner: "{{ mrm_internal_root_user }}" # root
mrm_fs_group: "{{ mrm_internal_root_group }}" # root/wheel
mrm_fs_mode: "0700"

# The default base dir respect Filesystem Hierarchy Standard 3.0
mrm_dir_base: 
  path: "/var/local/mrm/"
  owner: "{{ mrm_fs_owner }}"
  group: "{{ mrm_internal_root_group }}"
  mode: "{{ mrm_fs_mode }}"
  state: directory
  # recurse: yes
  # serole: ...
  # setype: ...
  # Check {{ role_path }}/tasks/setup-mrm-filesystem/main.yml for all options!

mrm_dir_backup:
  path: "{{ mrm_dir_base.path }}backups/"
  owner: "{{ mrm_fs_owner }}"
  group: "{{ mrm_internal_root_group }}"
  mode: "{{ mrm_fs_mode }}"
  state: directory

# Not implemented, but the folder at least exist if you want to implement
mrm_dir_mydumperdaemon:
  path: "{{ mrm_dir_base.path }}mydumper-daemon"
  owner: "{{ mrm_fs_owner }}"
  group: "{{ mrm_internal_root_group }}"
  mode: "{{ mrm_fs_mode }}"
  state: directory

mrm_dir_paranoidmode:
  path: "{{ mrm_dir_base.path }}full-temp-backup-before-recovery/"
  owner: "{{ mrm_fs_owner }}"
  group: "{{ mrm_internal_root_group }}"
  mode: "{{ mrm_fs_mode }}"
  state: directory
